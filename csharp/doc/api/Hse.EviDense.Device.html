<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Class Device | eviDense </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class Device | eviDense ">
      
      <meta name="description" content="This class represents the eviDense module.">
      <link rel="icon" href="../images/favicon.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../images/hseagohnesubzeile_cmyk_150px.png" alt="eviDense">
            eviDense
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="Hse.EviDense.Device">



  <h1 id="Hse_EviDense_Device" data-uid="Hse.EviDense.Device" class="text-break">
Class Device  
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="Hse.html">Hse</a>.<a class="xref" href="Hse.EviDense.html">EviDense</a></dd></dl>
  <dl><dt>Assembly</dt><dd>Hseagcom.EviDense.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>This class represents the eviDense module.</p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public class Device : IDisposable</code></pre>
  </div>




  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><span class="xref">Device</span></div>
    </dd>
  </dl>

  <dl class="typelist implements">
    <dt>Implements</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.idisposable">IDisposable</a></div>
    </dd>
  </dl>


  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone">object.MemberwiseClone()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
  </dd></dl>






  <h2 class="section" id="constructors">Constructors
</h2>


  <a id="Hse_EviDense_Device__ctor_" data-uid="Hse.EviDense.Device.#ctor*"></a>

  <h3 id="Hse_EviDense_Device__ctor_System_String_" data-uid="Hse.EviDense.Device.#ctor(System.String)">
  Device(string?)
  
  </h3>

  <div class="markdown level1 summary"><p>Initializes a new instance of the <a class="xref" href="Hse.EviDense.Device.html">Device</a> class.
The constructor attempts to connect to an EviDense module via a serial port.
If no serial port is provided, it tries to auto-detect the device.</p>
<p>Throws an exception if:</p>
<ul>
<li>No device is found during auto-detection.</li>
<li>The provided serial port does not match the expected VID/PID for the EviDense device.</li>
</ul>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public Device(string? serialNumber = null)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>serialNumber</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>The serial number of the device to connect to. If null or empty, the constructor
attempts to automatically find a device.</p>
</dd>
  </dl>









  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.exception">Exception</a></dt>
    <dd><p>Thrown when:</p>
<ul>
<li>No device is found during auto-detection (if <code class="paramref">serialNumber</code> is null or empty).</li>
<li>The provided serial port does not correspond to an EviDense device.</li>
</ul>
</dd>
  </dl>



  <h2 class="section" id="properties">Properties
</h2>


  <a id="Hse_EviDense_Device_LibraryVersion_" data-uid="Hse.EviDense.Device.LibraryVersion*"></a>

  <h3 id="Hse_EviDense_Device_LibraryVersion" data-uid="Hse.EviDense.Device.LibraryVersion">
  LibraryVersion
  
  </h3>

  <div class="markdown level1 summary"><p>Gets the version of the eviDense library.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public string LibraryVersion { get; }</code></pre>
  </div>





  <h4 class="section">Property Value</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd></dd>
  </dl>








  <h2 class="section" id="methods">Methods
</h2>


  <a id="Hse_EviDense_Device_AddSelfTestDetails_" data-uid="Hse.EviDense.Device.AddSelfTestDetails*"></a>

  <h3 id="Hse_EviDense_Device_AddSelfTestDetails_System_Text_Json_Nodes_JsonNode_" data-uid="Hse.EviDense.Device.AddSelfTestDetails(System.Text.Json.Nodes.JsonNode)">
  AddSelfTestDetails(JsonNode?)
  
  </h3>

  <div class="markdown level1 summary"><p>Adds detailed self-test measurement data to a given JSON node.
The method retrieves various self-test parameters from the device and stores them in the provided
JSON structure, including amplifier values and LED measurement data for different wavelengths.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void AddSelfTestDetails(JsonNode? node)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>node</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.text.json.nodes.jsonnode">JsonNode</a></dt>
    <dd><p>A <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.text.json.nodes.jsonnode">JsonNode</a> object where the self-test details will be stored.</p>
</dd>
  </dl>








  <h4 class="section" id="Hse_EviDense_Device_AddSelfTestDetails_System_Text_Json_Nodes_JsonNode__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>The method follows these steps:</p>
<ol>
<li>Retrieves amplifier-related self-test values and adds them to the JSON node.</li>
<li>Uses the helper method <code>LedAsJson</code> to fetch and structure LED-specific measurement data for
different wavelengths (230nm, 260nm, 280nm, and 340nm).</li>
<li>Each LED entry contains:
<ul>
<li>ILED (LED intensity)</li>
<li>Dark Sample</li>
<li>Dark Reference</li>
<li>Sample</li>
<li>Reference</li>
</ul>
</li>
</ol>
</div>

  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.argumentnullexception">ArgumentNullException</a></dt>
    <dd><p>Thrown if the provided <code class="paramref">node</code> is <code>null</code>.</p>
</dd>
  </dl>



  <a id="Hse_EviDense_Device_Baseline_" data-uid="Hse.EviDense.Device.Baseline*"></a>

  <h3 id="Hse_EviDense_Device_Baseline" data-uid="Hse.EviDense.Device.Baseline">
  Baseline()
  
  </h3>

  <div class="markdown level1 summary"><p>Retrieves the baseline measurement data from the device and constructs a <a class="xref" href="Hse.EviDense.SingleMeasurement.html">SingleMeasurement</a> object.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public SingleMeasurement Baseline()</code></pre>
  </div>


  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="Hse.EviDense.SingleMeasurement.html">SingleMeasurement</a></dt>
    <dd><p>A <a class="xref" href="Hse.EviDense.SingleMeasurement.html">SingleMeasurement</a> object containing the baseline data for the four channels (230nm, 260nm, 280nm, and 340nm).</p>
</dd>
  </dl>







  <h4 class="section" id="Hse_EviDense_Device_Baseline_remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>This command expects an empty cuvette guide. If required, the module executes a <a class="xref" href="Hse.EviDense.Device.html#Hse_EviDense_Device_Levelling">Levelling()</a> command internally and then starts a measurement.
if needed and starts after wards a measurement.</p>
</div>

  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.formatexception">FormatException</a></dt>
    <dd><p>Thrown if any of the response values from the device cannot be parsed as integers.</p>
</dd>
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.exception">Exception</a></dt>
    <dd><p>Thrown if the device response is invalid or does not contain the expected number of values.</p>
</dd>
  </dl>



  <a id="Hse_EviDense_Device_Dispose_" data-uid="Hse.EviDense.Device.Dispose*"></a>

  <h3 id="Hse_EviDense_Device_Dispose" data-uid="Hse.EviDense.Device.Dispose">
  Dispose()
  
  </h3>

  <div class="markdown level1 summary"><p>Releases all resources used by the <a class="xref" href="Hse.EviDense.Device.html">Device</a>.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void Dispose()</code></pre>
  </div>













  <a id="Hse_EviDense_Device_Finalize_" data-uid="Hse.EviDense.Device.Finalize*"></a>

  <h3 id="Hse_EviDense_Device_Finalize" data-uid="Hse.EviDense.Device.Finalize">
  ~Device()
  
  </h3>

  <div class="markdown level1 summary"><p>Finalizer for <a class="xref" href="Hse.EviDense.Device.html">Device</a>.
Ensures the device is properly disposed.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">protected ~Device()</code></pre>
  </div>













  <a id="Hse_EviDense_Device_FirmwareVersion_" data-uid="Hse.EviDense.Device.FirmwareVersion*"></a>

  <h3 id="Hse_EviDense_Device_FirmwareVersion" data-uid="Hse.EviDense.Device.FirmwareVersion">
  FirmwareVersion()
  
  </h3>

  <div class="markdown level1 summary"><p>Retrieves the firmware version of the connected device.
This method uses the <a class="xref" href="Hse.EviDense.Device.html#Hse_EviDense_Device_Get__1_Hse_EviDense_Index_">Get&lt;T&gt;(Index)</a> method to fetch the firmware version
from the device at the predefined index for firmware versions.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public string FirmwareVersion()</code></pre>
  </div>


  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>The firmware version of the device as a string.</p>
</dd>
  </dl>








  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.invalidcastexception">InvalidCastException</a></dt>
    <dd><p>Thrown if the retrieval or conversion of the firmware version fails.</p>
</dd>
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.exception">Exception</a></dt>
    <dd><p>Thrown if there is an issue communicating with the device or retrieving the value.</p>
</dd>
  </dl>



  <a id="Hse_EviDense_Device_FwUpdate_" data-uid="Hse.EviDense.Device.FwUpdate*"></a>

  <h3 id="Hse_EviDense_Device_FwUpdate_System_String_" data-uid="Hse.EviDense.Device.FwUpdate(System.String)">
  FwUpdate(string)
  
  </h3>

  <div class="markdown level1 summary"><p>Performs a firmware update on the device.
The method reads the firmware file, erases the existing firmware, writes the new firmware line by line,
and then verifies its validity. If the update fails at any stage, an exception is thrown.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void FwUpdate(string filename)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>filename</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>The path to the firmware file that contains the new firmware image.</p>
</dd>
  </dl>








  <h4 class="section" id="Hse_EviDense_Device_FwUpdate_System_String__remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>The update process follows these steps:</p>
<ol>
<li>Read all lines from the specified firmware file.</li>
<li>Erase the existing firmware using <span class="xref">Hse.EviDense.Device.erase()</span>.</li>
<li>Send each line of the new firmware to the device using the &quot;S {line}&quot; command.</li>
<li>Verify the firmware using <a class="xref" href="Hse.EviDense.Device.html#Hse_EviDense_Device_verify">verify()</a>; if verification fails, throw an exception.</li>
<li>Reboot the device and close the serial port.</li>
<li>Wait for 30 seconds to allow the device to restart.</li>
<li>Reopen the serial port and clear its buffers.</li>
<li>Verify the firmware again; if verification still passes, throw an exception indicating the update failed.</li>
</ol>
</div>

  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.io.ioexception">IOException</a></dt>
    <dd><p>Thrown if the firmware file cannot be read.</p>
</dd>
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.exception">Exception</a></dt>
    <dd><p>Thrown if the firmware update fails at any stage (e.g., verification fails before or after reboot).</p>
</dd>
  </dl>



  <a id="Hse_EviDense_Device_GetAdcValues_" data-uid="Hse.EviDense.Device.GetAdcValues*"></a>

  <h3 id="Hse_EviDense_Device_GetAdcValues" data-uid="Hse.EviDense.Device.GetAdcValues">
  GetAdcValues()
  
  </h3>

  <div class="markdown level1 summary"><p>Get ADC values.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public AdcResult GetAdcValues()</code></pre>
  </div>


  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="Hse.EviDense.AdcResult.html">AdcResult</a></dt>
    <dd></dd>
  </dl>











  <a id="Hse_EviDense_Device_GetAvailableDevices_" data-uid="Hse.EviDense.Device.GetAvailableDevices*"></a>

  <h3 id="Hse_EviDense_Device_GetAvailableDevices" data-uid="Hse.EviDense.Device.GetAvailableDevices">
  GetAvailableDevices()
  
  </h3>

  <div class="markdown level1 summary"><p>Retrieves a list of available eviDense devices by scanning serial ports.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public static List&lt;string&gt; GetAvailableDevices()</code></pre>
  </div>


  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.collections.generic.list-1">List</a>&lt;<a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a>&gt;</dt>
    <dd><p>A list of serial numbers of available matching devices.</p>
</dd>
  </dl>











  <a id="Hse_EviDense_Device_Get_" data-uid="Hse.EviDense.Device.Get*"></a>

  <h3 id="Hse_EviDense_Device_Get__1_Hse_EviDense_Index_" data-uid="Hse.EviDense.Device.Get``1(Hse.EviDense.Index)">
  Get&lt;T&gt;(Index)
  
  </h3>

  <div class="markdown level1 summary"><p>Retrieves a value from the device at the specified index and converts it to the desired type.
Sends a command to the device to fetch the value and parses the response.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public T Get&lt;T&gt;(Index index)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>index</code> <a class="xref" href="Hse.EviDense.Index.html">Index</a></dt>
    <dd><p>The index from which the value should be retrieved.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><span class="xref">T</span></dt>
    <dd><p>The value retrieved from the device, converted to the specified type <code class="typeparamref">T</code>.</p>
</dd>
  </dl>

  <h4 class="section">Type Parameters</h4>
  <dl class="parameters">
    <dt><code>T</code></dt>
    <dd><p>The type to which the retrieved value will be converted. Must be compatible with <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.convert.changetype#system-convert-changetype(system-object-system-type)">ChangeType(object, Type)</a>.</p>
</dd>
  </dl>







  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.invalidcastexception">InvalidCastException</a></dt>
    <dd><p>Thrown if the conversion to the specified type <code class="typeparamref">T</code> fails.</p>
</dd>
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.exception">Exception</a></dt>
    <dd><p>Thrown if the device response is invalid or does not contain the expected data format.</p>
</dd>
  </dl>



  <a id="Hse_EviDense_Device_IsCuvetteHolderEmpty_" data-uid="Hse.EviDense.Device.IsCuvetteHolderEmpty*"></a>

  <h3 id="Hse_EviDense_Device_IsCuvetteHolderEmpty" data-uid="Hse.EviDense.Device.IsCuvetteHolderEmpty">
  IsCuvetteHolderEmpty()
  
  </h3>

  <div class="markdown level1 summary"><p>Checks whether the cuvette holder is empty.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public bool IsCuvetteHolderEmpty()</code></pre>
  </div>


  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p><code>true</code> if the cuvette holder is empty; otherwise, <code>false</code>.</p>
</dd>
  </dl>








  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.formatexception">FormatException</a></dt>
    <dd><p>Thrown if the response value from the device cannot be parsed as an integer.</p>
</dd>
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.indexoutofrangeexception">IndexOutOfRangeException</a></dt>
    <dd><p>Thrown if the device response does not contain the expected number of values.</p>
</dd>
  </dl>



  <a id="Hse_EviDense_Device_Levelling_" data-uid="Hse.EviDense.Device.Levelling*"></a>

  <h3 id="Hse_EviDense_Device_Levelling" data-uid="Hse.EviDense.Device.Levelling">
  Levelling()
  
  </h3>

  <div class="markdown level1 summary"><p>Retrieves levelling data from the device and parses it into a <a class="xref" href="Hse.EviDense.LevellingResult.html">LevellingResult</a> object.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public LevellingResult Levelling()</code></pre>
  </div>


  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="Hse.EviDense.LevellingResult.html">LevellingResult</a></dt>
    <dd><p>A <a class="xref" href="Hse.EviDense.LevellingResult.html">LevellingResult</a> object containing the parsed levelling data for all channels.</p>
</dd>
  </dl>







  <h4 class="section" id="Hse_EviDense_Device_Levelling_remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>This command expects and empty cuvette guide.
Each LED channel current is set so that the detector measures 90% of the maximum level.</p>
</div>

  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.formatexception">FormatException</a></dt>
    <dd><p>Thrown if any of the device's response values cannot be parsed as integers.</p>
</dd>
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.exception">Exception</a></dt>
    <dd><p>Thrown if the device response is invalid or does not contain the expected number of values.</p>
</dd>
  </dl>



  <a id="Hse_EviDense_Device_Measure_" data-uid="Hse.EviDense.Device.Measure*"></a>

  <h3 id="Hse_EviDense_Device_Measure" data-uid="Hse.EviDense.Device.Measure">
  Measure()
  
  </h3>

  <div class="markdown level1 summary"><p>Performs a measurement and retrieves data from the device.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public SingleMeasurement Measure()</code></pre>
  </div>


  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="Hse.EviDense.SingleMeasurement.html">SingleMeasurement</a></dt>
    <dd><p>A <a class="xref" href="Hse.EviDense.SingleMeasurement.html">SingleMeasurement</a> object containing the measured data for four channels.</p>
</dd>
  </dl>








  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.formatexception">FormatException</a></dt>
    <dd><p>Thrown if any of the response values from the device cannot be parsed as integers.</p>
</dd>
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.indexoutofrangeexception">IndexOutOfRangeException</a></dt>
    <dd><p>Thrown if the device response does not contain the expected number of values.</p>
</dd>
  </dl>



  <a id="Hse_EviDense_Device_ProductionNumber_" data-uid="Hse.EviDense.Device.ProductionNumber*"></a>

  <h3 id="Hse_EviDense_Device_ProductionNumber" data-uid="Hse.EviDense.Device.ProductionNumber">
  ProductionNumber()
  
  </h3>

  <div class="markdown level1 summary"><p>Retrieves the production number of the connected device.
This method uses the <a class="xref" href="Hse.EviDense.Device.html#Hse_EviDense_Device_Get__1_Hse_EviDense_Index_">Get&lt;T&gt;(Index)</a> method to fetch the production number
from the device at the predefined index.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public string ProductionNumber()</code></pre>
  </div>


  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>The production number of the device as a string.</p>
</dd>
  </dl>








  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.exception">Exception</a></dt>
    <dd><p>Thrown if there is an issue communicating with the device or retrieving the value.</p>
</dd>
  </dl>



  <a id="Hse_EviDense_Device_SelfTest_" data-uid="Hse.EviDense.Device.SelfTest*"></a>

  <h3 id="Hse_EviDense_Device_SelfTest" data-uid="Hse.EviDense.Device.SelfTest">
  SelfTest()
  
  </h3>

  <div class="markdown level1 summary"><p>Performs a self-test on the device and retrieves the result.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public SelfTestResult SelfTest()</code></pre>
  </div>


  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="Hse.EviDense.SelfTestResult.html">SelfTestResult</a></dt>
    <dd><p>A <a class="xref" href="Hse.EviDense.SelfTestResult.html">SelfTestResult</a> object containing the parsed self-test result.</p>
</dd>
  </dl>








  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.formatexception">FormatException</a></dt>
    <dd><p>Thrown if the response value from the device cannot be parsed as an integer.</p>
</dd>
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.indexoutofrangeexception">IndexOutOfRangeException</a></dt>
    <dd><p>Thrown if the device response does not contain the expected number of values.</p>
</dd>
  </dl>



  <a id="Hse_EviDense_Device_SerialNumber_" data-uid="Hse.EviDense.Device.SerialNumber*"></a>

  <h3 id="Hse_EviDense_Device_SerialNumber" data-uid="Hse.EviDense.Device.SerialNumber">
  SerialNumber()
  
  </h3>

  <div class="markdown level1 summary"><p>Retrieves the serial number of the connected device.
This method uses the <a class="xref" href="Hse.EviDense.Device.html#Hse_EviDense_Device_Get__1_Hse_EviDense_Index_">Get&lt;T&gt;(Index)</a> method to fetch the serial number
from the device at the predefined index for serial numbers.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public string SerialNumber()</code></pre>
  </div>


  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>The serial number of the device as a string.</p>
</dd>
  </dl>








  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.invalidcastexception">InvalidCastException</a></dt>
    <dd><p>Thrown if the retrieval or conversion of the serial number fails.</p>
</dd>
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.exception">Exception</a></dt>
    <dd><p>Thrown if there is an issue communicating with the device or retrieving the value.</p>
</dd>
  </dl>



  <a id="Hse_EviDense_Device_Set_" data-uid="Hse.EviDense.Device.Set*"></a>

  <h3 id="Hse_EviDense_Device_Set_Hse_EviDense_Index_System_Double_" data-uid="Hse.EviDense.Device.Set(Hse.EviDense.Index,System.Double)">
  Set(Index, double)
  
  </h3>

  <div class="markdown level1 summary"><p>Sets a value on the device at the specified index.
Sends a command to update the value on the device.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void Set(Index index, double value)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>index</code> <a class="xref" href="Hse.EviDense.Index.html">Index</a></dt>
    <dd><p>The index where the value should be set.</p>
</dd>
    <dt><code>value</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.double">double</a></dt>
    <dd><p>The double value to set at the specified index.</p>
</dd>
  </dl>












  <a id="Hse_EviDense_Device_Set_" data-uid="Hse.EviDense.Device.Set*"></a>

  <h3 id="Hse_EviDense_Device_Set_Hse_EviDense_Index_System_Int32_" data-uid="Hse.EviDense.Device.Set(Hse.EviDense.Index,System.Int32)">
  Set(Index, int)
  
  </h3>

  <div class="markdown level1 summary"><p>Sets a value on the device at the specified index.
Sends a command to update the value on the device.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void Set(Index index, int value)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>index</code> <a class="xref" href="Hse.EviDense.Index.html">Index</a></dt>
    <dd><p>The index where the value should be set.</p>
</dd>
    <dt><code>value</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd><p>The integer value to set at the specified index.</p>
</dd>
  </dl>












  <a id="Hse_EviDense_Device_Set_" data-uid="Hse.EviDense.Device.Set*"></a>

  <h3 id="Hse_EviDense_Device_Set_Hse_EviDense_Index_System_String_" data-uid="Hse.EviDense.Device.Set(Hse.EviDense.Index,System.String)">
  Set(Index, string)
  
  </h3>

  <div class="markdown level1 summary"><p>Sets a value on the device at the specified index.
Sends a command to update the value on the device.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void Set(Index index, string value)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>index</code> <a class="xref" href="Hse.EviDense.Index.html">Index</a></dt>
    <dd><p>The index where the value should be set.</p>
</dd>
    <dt><code>value</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>The string value to set at the specified index.</p>
</dd>
  </dl>












  <a id="Hse_EviDense_Device_SetAmplifiyingFactor_" data-uid="Hse.EviDense.Device.SetAmplifiyingFactor*"></a>

  <h3 id="Hse_EviDense_Device_SetAmplifiyingFactor_Hse_EviDense_Amplifier_Hse_EviDense_AmplifierFactors_" data-uid="Hse.EviDense.Device.SetAmplifiyingFactor(Hse.EviDense.Amplifier,Hse.EviDense.AmplifierFactors)">
  SetAmplifiyingFactor(Amplifier, AmplifierFactors)
  
  </h3>

  <div class="markdown level1 summary"><p>Set the amplification factor of the given amplifier.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void SetAmplifiyingFactor(Amplifier amplifier, AmplifierFactors factor)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>amplifier</code> <a class="xref" href="Hse.EviDense.Amplifier.html">Amplifier</a></dt>
    <dd></dd>
    <dt><code>factor</code> <a class="xref" href="Hse.EviDense.AmplifierFactors.html">AmplifierFactors</a></dt>
    <dd></dd>
  </dl>












  <a id="Hse_EviDense_Device_SetLedAndCurrent_" data-uid="Hse.EviDense.Device.SetLedAndCurrent*"></a>

  <h3 id="Hse_EviDense_Device_SetLedAndCurrent_Hse_EviDense_Led_System_Int32_" data-uid="Hse.EviDense.Device.SetLedAndCurrent(Hse.EviDense.Led,System.Int32)">
  SetLedAndCurrent(Led, int)
  
  </h3>

  <div class="markdown level1 summary"><p>Sets the current of the given LED. Current is in uA.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void SetLedAndCurrent(Led led, int current)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>led</code> <a class="xref" href="Hse.EviDense.Led.html">Led</a></dt>
    <dd></dd>
    <dt><code>current</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.int32">int</a></dt>
    <dd></dd>
  </dl>












  <a id="Hse_EviDense_Device_SetStatusLed_" data-uid="Hse.EviDense.Device.SetStatusLed*"></a>

  <h3 id="Hse_EviDense_Device_SetStatusLed_Hse_EviDense_StatusLedColor_" data-uid="Hse.EviDense.Device.SetStatusLed(Hse.EviDense.StatusLedColor)">
  SetStatusLed(StatusLedColor)
  
  </h3>

  <div class="markdown level1 summary"><p>Sets the status led color.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void SetStatusLed(StatusLedColor color)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>color</code> <a class="xref" href="Hse.EviDense.StatusLedColor.html">StatusLedColor</a></dt>
    <dd></dd>
  </dl>












  <a id="Hse_EviDense_Device_TechnicalReport_" data-uid="Hse.EviDense.Device.TechnicalReport*"></a>

  <h3 id="Hse_EviDense_Device_TechnicalReport" data-uid="Hse.EviDense.Device.TechnicalReport">
  TechnicalReport()
  
  </h3>

  <div class="markdown level1 summary"><p>Generates a technical report containing various diagnostic data from the device.
The report includes levelling results, self-test data, serial number, and firmware version.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public JsonNode TechnicalReport()</code></pre>
  </div>


  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.text.json.nodes.jsonnode">JsonNode</a></dt>
    <dd><p>A <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.text.json.nodes.jsonnode">JsonNode</a> object containing structured diagnostic data.</p>
</dd>
  </dl>







  <h4 class="section" id="Hse_EviDense_Device_TechnicalReport_remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>The generated report consists of the following fields:</p>
<ul>
<li><a class="xref" href="Hse.EviDense.Dict.html#Hse_EviDense_Dict_LEVELLING">LEVELLING</a>: The levelling results in JSON format.</li>
<li><a class="xref" href="Hse.EviDense.Dict.html#Hse_EviDense_Dict_SELFTEST">SELFTEST</a>: The base self-test results in JSON format, with additional details added via <a class="xref" href="Hse.EviDense.Device.html#Hse_EviDense_Device_AddSelfTestDetails_System_Text_Json_Nodes_JsonNode_">AddSelfTestDetails(JsonNode?)</a>.</li>
<li><a class="xref" href="Hse.EviDense.Dict.html#Hse_EviDense_Dict_SERIALNUMBER">SERIALNUMBER</a>: The device's serial number.</li>
<li><a class="xref" href="Hse.EviDense.Dict.html#Hse_EviDense_Dict_FIRMWAREVERSION">FIRMWAREVERSION</a>: The firmware version currently installed on the device.</li>
<li><a class="xref" href="Hse.EviDense.Dict.html#Hse_EviDense_Dict_PRODUCTIONNUMBER">PRODUCTIONNUMBER</a>: The device's production number.</li>
</ul>
</div>




  <a id="Hse_EviDense_Device_ToString_" data-uid="Hse.EviDense.Device.ToString*"></a>

  <h3 id="Hse_EviDense_Device_ToString" data-uid="Hse.EviDense.Device.ToString">
  ToString()
  
  </h3>

  <div class="markdown level1 summary"><p>Returns a string representation of the device, including its serial port, serial number, and firmware version.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public override string ToString()</code></pre>
  </div>


  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>A formatted string containing the device's port name, serial number, and firmware version.</p>
</dd>
  </dl>







  <h4 class="section" id="Hse_EviDense_Device_ToString_remarks">Remarks</h4>
  <div class="markdown level1 remarks"><p>The returned string follows the format:
&quot;eviDense Module@{PortName} SN:{SerialNumber} Version:{FirmwareVersion}&quot;
Example output:
&quot;eviDense Module@COM3 SN:12345678 Version:1.0.5&quot;</p>
</div>




  <a id="Hse_EviDense_Device_verify_" data-uid="Hse.EviDense.Device.verify*"></a>

  <h3 id="Hse_EviDense_Device_verify" data-uid="Hse.EviDense.Device.verify">
  verify()
  
  </h3>

  <div class="markdown level1 summary"><p>Verifies if the 2nd firmware image is valid.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public bool verify()</code></pre>
  </div>


  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.boolean">bool</a></dt>
    <dd><p><code>true</code> if the verification was successful; otherwise, <code>false</code>.</p>
</dd>
  </dl>








  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.formatexception">FormatException</a></dt>
    <dd><p>Thrown if the response value from the device cannot be parsed as an integer.</p>
</dd>
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.indexoutofrangeexception">IndexOutOfRangeException</a></dt>
    <dd><p>Thrown if the device response does not contain the expected number of values.</p>
</dd>
  </dl>




</article>

        <div class="contribution d-print-none">
        </div>


      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <span>Made with <a href="https://dotnet.github.io/docfx">docfx</a></span>
        </div>
      </div>
    </footer>
  </body>
</html>
